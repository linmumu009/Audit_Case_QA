import pandas as pd
import numpy as np
from datetime import datetime, timedelta
import random

# 1. 定义基础数据（确保省市对应、区县合理）
provinces_cities_districts = {
    "北京市": {
        "城市": ["北京市"],
        "区县": ["东城区", "西城区", "朝阳区", "海淀区", "丰台区", "石景山区", "通州区", "顺义区", "昌平区", "大兴区"]
    },
    "上海市": {
        "城市": ["上海市"],
        "区县": ["黄浦区", "徐汇区", "长宁区", "静安区", "普陀区", "虹口区", "杨浦区", "闵行区", "宝山区", "嘉定区"]
    },
    "广东省": {
        "城市": ["广州市", "深圳市", "佛山市", "东莞市", "中山市", "珠海市"],
        "区县": ["越秀区", "天河区", "海珠区", "番禺区", "南山区", "福田区", "宝安区", "顺德区", "南海区", "莞城区"]
    },
    "江苏省": {
        "城市": ["南京市", "苏州市", "无锡市", "常州市", "扬州市", "镇江市"],
        "区县": ["鼓楼区", "秦淮区", "苏州工业园区", "虎丘区", "滨湖区", "新北区", "天宁区", "广陵区", "京口区"]
    },
    "浙江省": {
        "城市": ["杭州市", "宁波市", "温州市", "嘉兴市", "绍兴市", "金华市"],
        "区县": ["西湖区", "余杭区", "萧山区", "鄞州区", "海曙区", "鹿城区", "瓯海区", "南湖区", "越城区"]
    },
    "山东省": {
        "城市": ["济南市", "青岛市", "烟台市", "潍坊市", "淄博市", "临沂市"],
        "区县": ["历下区", "市南区", "崂山区", "芝罘区", "奎文区", "张店区", "兰山区", "罗庄区"]
    },
    "四川省": {
        "城市": ["成都市", "绵阳市", "德阳市", "宜宾市", "南充市"],
        "区县": ["锦江区", "武侯区", "成华区", "涪城区", "旌阳区", "翠屏区", "顺庆区"]
    },
    "湖北省": {
        "城市": ["武汉市", "宜昌市", "襄阳市", "黄石市"],
        "区县": ["武昌区", "汉口区", "汉阳区", "西陵区", "襄城区", "黄石港区"]
    },
    "河南省": {
        "城市": ["郑州市", "洛阳市", "开封市", "新乡市"],
        "区县": ["金水区", "中原区", "洛龙区", "老城区", "龙亭区", "红旗区"]
    },
    "陕西省": {
        "城市": ["西安市", "宝鸡市", "咸阳市"],
        "区县": ["雁塔区", "碑林区", "莲湖区", "渭滨区", "秦都区"]
    }
}

# 2. 定义保险行业常见审计缺陷内容（按子公司类型分类，确保50字左右）
defect_contents = {
    "产险": [
        "机动车险承保未核验车架号唯一性，15笔保单存在套牌车辆承保，违反机动车险核保规则，涉保费4.2万元",
        "企财险续保未重新评估企业风险等级，高风险企业按原费率续保，28笔保单存在费率不足风险",
        "工程险理赔未审核工程进度证明，12笔理赔案对应工程未达损失节点，多支付理赔金89万元",
        "货运险保单未明确运输路线，7笔理赔因路线偏离引发责任争议，未按监管要求完善条款要素",
        "公众责任险承保未核实被保险人经营资质，19笔保单对应主体无营业许可证，不符合承保条件",
        "交强险保单批改未留存客户申请材料，23笔批改记录无书面申请，违反保单批改档案管理规定",
        "车辆损失险定损未使用统一定损标准，不同定损员对同款损失定损差额达30%，引发客户投诉",
        "火灾险承保前未实地查勘风险点，11笔保单对应场所存在消防设施缺失，未采取加费措施",
        "雇主责任险理赔未核实工伤认定结论，8笔理赔案无社保部门工伤认定书，涉及金额45万元",
        "农业险承保未核实投保标的数量，27笔农险保单存在虚增种植面积，涉保费12.8万元",
        "船舶险核保未审核船舶适航证书，9笔保单对应船舶超期未年检，存在承保合规风险",
        "责任险保费计算错误，部分场所责任险按面积少算保费，18笔保单少收保费5.7万元",
        "产险理赔档案缺失现场照片，41笔2023年理赔案无损失现场影像资料，违反档案完整性要求",
        "短期意外险（产险）销售未提示免责条款，35名客户因未知晓免责拒赔投诉，违反销售规范",
        "盗抢险理赔未核实警方立案证明，6笔理赔案无正式立案文书，存在虚假理赔风险",
        "建工一切险未明确免赔额计算方式，10笔理赔因免赔额争议引发诉讼，未完善条款表述",
        "机动车险退保未按比例退还保费，14名客户被多扣退保手续费，合计2.3万元，违反退费规则",
        "企财险核保未审核企业财务报表，16笔保单对应企业资不抵债，存在承保偿付能力风险",
        "货运险理赔未核实货物运输发票，21笔理赔案无合规运输发票，无法佐证运输事实",
        "产品责任险承保未评估产品召回风险，8笔保单对应产品存在召回记录，未调整承保条件",
        "交强险代缴车船税未足额上缴税务部门，32笔保单少缴车船税合计6.8万元，违反税务合规要求",
        "车辆划痕险核赔未比对维修记录，9笔理赔案维修项目与划痕损失无关，涉虚假理赔3.5万元",
        "工程险保费分期收取未约定逾期罚则，15笔保单保费逾期超90天，未采取催收措施",
        "公众责任险理赔未划分事故责任比例，7笔理赔全额赔付非被保险人全责损失，多赔28万元",
        "农业险查勘未使用GPS定位标的，13笔理赔案查勘记录地址与实际种植地不符，涉虚假理赔",
        "产险代理人代填投保单，47笔保单投保信息非投保人亲笔填写，违反投保自愿原则",
        "船舶险理赔未审核海事事故报告，5笔理赔案无官方事故认定书，无法佐证损失原因",
        "雇主责任险保费未按员工人数调整，12笔保单员工人数增加未补收保费，少收3.9万元",
        "机动车险核保未审核酒驾记录，7笔保单投保人有酒驾史仍承保，增加理赔风险",
        "企财险理赔未评估残值，18笔理赔案未扣除受损资产残值，多支付理赔金15万元",
        "货运险承保未限定运输工具类型，9笔保单货物由非标车辆运输，违反承保条件",
        "责任险条款与监管新规冲突，42笔保单条款未更新，不符合2023年责任险监管要求",
        "产险理赔支付未核实收款账户，6笔理赔金转入非被保险人账户，存在资金挪用风险",
        "短期健康险（产险）未按监管要求设置保证续保条款，19笔保单违规承诺终身续保",
        "火灾险理赔未审核消防事故认定书，11笔理赔案无消防部门责任认定，无法确定保险责任",
        "机动车险投保影像资料缺失，28笔保单无投保人身份证影像，违反核保资料完整性要求",
        "工程险未跟踪工程风险变化，在建工程增加高风险工序未调整承保条件，涉10笔保单",
        "企财险退保未留存退保原因说明，33笔退保记录无客户书面说明，违反退保档案管理规定",
        "货运险理赔未核实货物损失程度，14笔理赔按全损赔付但实际为部分损失，多赔42万元",
        "公众责任险未按场所类型分类费率，17笔高风险场所按普通场所收费，少收保费7.1万元",
        "交强险保单信息录入错误，26笔保单车牌号与车架号不匹配，无法正常理赔",
        "车辆损失险代位求偿未及时发起，18笔符合代位条件的案件超期未处理，损失无法追偿",
        "农业险理赔未公示损失信息，22笔农险理赔未按要求在村社公示，违反农险监管规定",
        "船舶险保费未按船舶吨位调整，8笔保单超吨位船舶按低吨位收费，少收保费4.3万元",
        "雇主责任险未明确伤残等级赔付标准，9笔理赔因等级认定争议引发投诉，未完善条款",
        "产险核保权限下放违规，基层机构超权限承保高风险业务，15笔保单无总公司审批",
        "机动车险未核实投保车辆使用性质，21笔营运车辆按非营运承保，少收保费8.9万元",
        "企财险理赔未审核维修发票真实性，13笔理赔使用虚假发票，涉及金额36万元",
        "工程险承保未审核施工合同，7笔保单对应合同无效，无法确定保险标的合法性",
        "货运险未约定货物运输时效，10笔理赔因超时运输引发责任争议，未完善条款要素",
        "责任险理赔调查未形成书面报告，27笔理赔调查无正式报告，仅口头记录，违反流程要求",
        "交强险理赔未优先支付医疗费用，8笔理赔案医疗费用未足额垫付，违反交强险赔付规则",
        "车辆划痕险承保未验车，14笔保单承保前车辆已存在划痕，引发理赔纠纷",
        "火灾险保费未按建筑耐火等级调整，12笔高耐火等级建筑多收保费，合计3.4万元",
        "农业险承保未签订正式投保协议，19笔保单仅口头约定，无书面协议，违反承保流程",
        "船舶险理赔未核实维修船厂资质，6笔理赔案船厂无修船资质，维修质量无法保障",
        "雇主责任险续保未核实员工名单，11笔保单存在离职员工续保，涉保费2.8万元",
        "产险销售未留存双录资料，45笔保单无销售过程录音录像，违反监管双录要求",
        "机动车险核赔未审核维修清单，17笔理赔维修项目与损失无关，多赔19万元",
        "企财险未按资产价值调整保额，23笔保单保额低于资产实际价值，不足额承保",
        "工程险理赔未审核监理报告，8笔理赔案无监理损失确认，无法佐证损失真实性",
        "货运险承保未审核货物包装方式，15笔易碎品未按要求包装仍承保，增加破损理赔风险",
        "公众责任险未投保不计免赔险，7笔理赔因免赔额争议导致客户拒付自付部分，引发投诉",
        "交强险保单未送达投保人，18笔保单无投保人签收记录，违反保单送达流程",
        "车辆损失险未明确配件更换标准，12笔理赔案旧配件未回收，存在重复理赔风险",
        "火灾险理赔未核算施救费用，9笔理赔案施救费用超标准赔付，多支付8.7万元",
        "农业险查勘人员无资质，14名查勘员未取得农险查勘资格证，违反人员管理规定",
        "船舶险未购买再保险，单笔保单保额超自留额3倍，存在大额赔付风险",
        "雇主责任险理赔未扣减工伤基金赔付，6笔理赔案重复赔付，多支付12.5万元",
        "产险财务未及时确认保费收入，32笔保单保费到账超30天未入账，违反财务核算准则",
        "机动车险未核实投保人是否为车主，27笔保单投保人非车辆所有人，存在道德风险",
        "企财险承保未排除除外责任，8笔保单承保标的包含除外责任范围资产，引发拒赔投诉",
        "工程险未跟踪保险期限，5笔保单工程延期未批改保险期限，脱保期间发生损失",
        "货运险理赔未核实货物残值，11笔理赔案未扣除残值，多支付理赔金6.9万元",
        "责任险未按监管要求报送费率备案，19笔保单费率未备案，违反保险费率监管规定",
        "交强险退保未收回原保单，13笔退保保单未收回，存在重复理赔风险",
        "车辆划痕险理赔未拍照留证，8笔理赔案无损失前后对比照片，无法核实损失真实性",
        "火灾险承保未检查消防通道，15笔保单对应场所消防通道堵塞，未采取风险管控措施",
        "农业险保费补贴申请材料虚假，7笔保单伪造种植面积证明，骗取财政补贴4.1万元",
        "船舶险核保未审核船东资质，9笔保单船东无船舶运营资质，违反承保条件",
        "雇主责任险未明确赔偿限额，12笔理赔因限额争议导致赔付不足，引发客户投诉",
        "产险档案保管期限不足，2021年45笔理赔档案提前销毁，违反档案保管年限规定",
        "机动车险未提示免赔率，17名客户因未知晓免赔率拒付自付部分，引发投诉",
        "企财险理赔未进行第三方评估，10笔大额理赔案无第三方定损报告，存在定损不公风险",
        "工程险保费计算错误，部分项目按建筑面积少算保费，14笔保单少收5.6万元",
        "货运险未约定运输货物温度要求，8笔冷链货物因温度超标损失，引发理赔争议",
        "公众责任险理赔未核实事故发生时间，6笔理赔案事故发生在保险期限外，违规赔付",
        "交强险保费优惠计算错误，12笔保单违规享受无赔款优待，少收保费2.4万元",
        "车辆损失险理赔未审核维修工时费，19笔理赔案工时费超行业标准，多支付7.8万元",
        "火灾险未按要求计提未决赔款准备金，23笔未决理赔案准备金计提不足，违反财务规定",
        "农业险理赔支付超时限，18笔理赔案超30天未支付，违反农险理赔时效要求",
        "船舶险理赔未审核维修费用发票，7笔理赔案使用虚开发票，涉及金额28万元",
        "雇主责任险承保未审核企业工商年检，11笔保单企业未年检，存在经营风险",
        "产险反欺诈排查未覆盖高风险保单，35笔高风险保单未纳入反欺诈筛查，存在欺诈风险",
        "机动车险批改未审核客户身份，14笔批改记录无身份验证，存在冒名批改风险",
        "企财险未投保机器损坏险附加险，8笔保单设备损坏无法理赔，引发客户投诉",
        "工程险承保未审核施工单位资质，15笔保单施工单位无资质，增加工程事故风险",
        "货运险保费未按货物价值比例收取，21笔高价值货物少收保费，合计9.2万元",
        "责任险理赔未履行代位求偿权，10笔第三方责任理赔未追偿，损失无法收回",
        "交强险未按要求报送理赔数据，27笔理赔数据未及时上报监管，违反数据报送规定"
    ],
    "寿险": [
        "个人寿险投保单健康告知代填，52笔保单健康信息非投保人填写，涉承保逆选择风险",
        "团体寿险承保未核实被保险人在职证明，31笔保单含离职人员，涉保费15.7万元",
        "年金险分红核算错误，28名客户分红金额少算，合计4.3万元，违反分红分配规则",
        "重疾险（寿险渠道）理赔未审核基因检测报告，7笔理赔案报告伪造，涉金额68万元",
        "万能险结算利率未按约定公示，19天未更新结算利率，违反监管信息披露要求",
        "寿险代理人超范围销售，23名代理人销售非本公司保单，违反代理人管理规定",
        "投连险未提示投资风险，41名客户因亏损投诉，称未告知投资波动风险",
        "寿险退保未按现金价值表计算，17名客户退保金额少付，合计3.8万元",
        "保单保全变更未留存客户授权，29笔保全记录无书面授权，违反保全流程要求",
        "团体寿险保费未按员工人数调整，14笔保单人数增加未补收保费，少收7.2万元",
        "个人寿险核保未审核体检报告，18笔保单投保人未体检仍承保，存在健康风险",
        "年金险未按约定支付生存金，9名客户生存金逾期支付超60天，引发投诉",
        "重疾险等待期计算错误，12笔理赔案等待期少算，违规赔付35万元",
        "万能险初始费用扣除比例错误，24笔保单多扣初始费用，合计5.1万元",
        "寿险销售误导，代理人承诺“保本保息”，37名客户投诉，违反销售行为规范",
        "投连险账户转换未收取手续费，18笔转换交易漏收手续费，少收2.9万元",
        "保单质押贷款未审核还款来源，23笔贷款无还款计划，逾期率超30%",
        "团体寿险理赔未核实员工工资流水，8笔理赔案无流水佐证收入损失，多赔12万元",
        "个人寿险保单未指定受益人，15笔保单身故理赔引发继承纠纷，违反投保规则",
        "年金险税收优惠计算错误，11名客户未享受税优政策，多缴个税2.7万元",
        "重疾险理赔调查未实地核实，14笔理赔案仅电话核实，无法确认病情真实性",
        "万能险部分领取未审核申请材料，9笔领取记录无客户书面申请，违反领取流程",
        "寿险代理人未持证销售，32名代理人无从业资格证，违反监管持证要求",
        "投连险投资账户信息未及时更新，17天未披露账户资产配置，违反信息披露规定",
        "保单复效未审核健康状况，28笔复效保单投保人健康恶化，未重新核保",
        "团体寿险未明确保障范围，12笔理赔案因范围争议拒赔，引发客户投诉",
        "个人寿险保费自动垫交未提示，19名客户不知情被垫交保费，产生利息争议",
        "年金险身故保险金计算错误，7笔理赔案少付保险金，合计8.4万元",
        "重疾险条款中疾病定义与监管不符，42笔保单未更新条款，违反重疾定义新规",
        "万能险风险保额计算错误，21笔保单风险保额不足，违反偿付能力监管要求",
        "寿险销售双录资料缺失，53笔保单无销售录音录像，无法佐证销售行为合规",
        "投连险赎回未按约定时效到账，14笔赎回申请超7天未到账，引发客户投诉",
        "保单挂失未核实客户身份，8笔挂失记录为冒名申请，存在保单被盗刷风险",
        "团体寿险续保未审核企业存续状态，11笔保单企业已注销仍续保，涉保费4.8万元",
        "个人寿险核保权限违规下放，基层机构超权限承保高风险客户，17笔保单无审批",
        "年金险未按监管要求报送产品备案，19款年金险产品未备案，违反产品监管规定",
        "重疾险理赔未扣除医保报销金额，13笔理赔案重复赔付，多支付26万元",
        "万能险保单管理费收取错误，27笔保单多收管理费，合计3.2万元",
        "寿险理赔档案缺失诊断证明，34笔理赔案无完整诊断资料，违反档案完整性要求",
        "投连险未提示账户管理费，28名客户投诉未告知管理费扣除规则，引发纠纷",
        "保单迁移未转移全部权益，12笔迁移保单遗漏分红权益，客户未收到分红",
        "团体寿险未投保附加意外医疗险，9笔理赔案意外医疗费用无法赔付，引发投诉",
        "个人寿险投保单签名笔迹不一致，41笔保单签名为代签，违反《保险法》投保要求",
        "年金险生存金领取方式变更未备案，15笔变更记录未向监管备案，违反备案规定",
        "重疾险等待期内发病未拒赔，8笔理赔案等待期内发病仍赔付，违规支付42万元",
        "万能险结算利率低于公示利率，14天结算利率不达标，违反合同约定",
        "寿险代理人挪用保费，7名代理人截留保费合计12.5万元，未上缴公司账户",
        "投连险投资组合偏离约定范围，权益类资产占比超上限5%，违反投资规则",
        "保单减保未按比例计算现金价值，19笔减保业务少付现金价值，合计2.6万元",
        "团体寿险理赔未审核事故证明，11笔理赔案无官方事故认定书，无法佐证事故真实性",
        "个人寿险未按要求计提准备金，32笔长期保单准备金计提不足，违反财务规定",
        "年金险未提供保单年度报告，24名客户未收到年度报告，违反信息披露要求",
        "重疾险理赔未审核治疗记录，16笔理赔案无完整治疗病历，存在虚假理赔风险",
        "万能险保单质押率计算错误，18笔贷款质押率超上限，增加坏账风险",
        "寿险销售未告知犹豫期，37名客户超犹豫期退保损失本金，引发投诉",
        "投连险未按约定进行风险评级，13款产品风险评级与实际不符，违反监管要求",
        "保单解除合同未退还剩余保费，9笔解除合同少退保费，合计1.8万元",
        "团体寿险未核实被保险人年龄，14笔保单存在超龄参保，违反承保年龄限制",
        "个人寿险核保未查询医保记录，23笔保单投保人医保记录显示带病，未核保排除",
        "年金险未按约定进行红利分配，17笔保单红利延迟分配超90天，违反合同约定",
        "重疾险理赔未审核手术记录，8笔理赔案无手术证明，仅凭诊断书赔付，涉28万元",
        "万能险未扣除保障成本，29笔保单漏扣保障成本，合计4.7万元，违反核算规则",
        "寿险代理人误导退保，12名代理人诱导客户退旧买新，赚取佣金，引发投诉",
        "投连险未披露投资亏损情况，19天未更新亏损信息，客户不知情继续投入",
        "保单复效利息计算错误，21笔复效保单多收利息，合计3.1万元",
        "团体寿险保费减免未审批，15笔保单违规减免保费，少收6.9万元",
        "个人寿险未提示保单失效风险，28名客户保费逾期保单失效，无法理赔",
        "年金险身故受益人变更未审核，7笔变更记录为冒名申请，引发继承纠纷",
        "重疾险条款免责范围未明确，14笔理赔案因免责争议拒赔，客户投诉率上升",
        "万能险部分领取限额错误，11笔领取超限额，违反合同约定，引发资金风险",
        "寿险理赔支付超时限，34笔理赔案超30天未支付，违反监管理赔时效要求",
        "投连险账户管理费收取错误，26笔保单少收管理费，合计2.3万元",
        "保单挂失后未冻结保单权益，8笔挂失保单仍被质押贷款，存在资金风险",
        "团体寿险未按人数调整保额，12笔保单人数减少未调低保额，超额承保",
        "个人寿险投保单地址信息错误，31笔保单地址无法送达，保单通知未签收",
        "年金险未参与红利分配，19笔保单应分红未分配，客户投诉未享受权益",
        "重疾险理赔未审核病理切片，9笔理赔案无病理切片报告，无法确认癌症类型",
        "万能险保单价值计算错误，24笔保单价值少算，合计5.8万元",
        "寿险销售未留存客户风险测评，45笔保单无风险测评记录，违反销售适当性要求",
        "投连险赎回手续费计算错误，17笔赎回多收手续费，合计3.4万元",
        "保单质押贷款逾期未催收，23笔贷款逾期超90天，未采取催收措施",
        "团体寿险理赔未扣除第三方赔付，10笔理赔案重复赔付，多支付18万元",
        "个人寿险核保未审核职业类别，18笔高风险职业按低风险承保，增加理赔风险",
        "年金险未按监管要求进行压力测试，12款年金险未开展利率压力测试，违反监管规定",
        "重疾险等待期内体检未拒保，7笔保单等待期内查出疾病仍承保，引发理赔争议",
        "万能险未公示费用扣除明细，29名客户未知晓费用扣除项目，引发投诉",
        "寿险代理人未进行继续教育，38名代理人未完成年度继续教育，违反人员管理规定",
        "投连险投资损失未如实告知，14名客户投诉未告知投资亏损，称被隐瞒风险",
        "保单减额交清计算错误，11笔减额交清保单保额计算错误，少保12万元",
        "团体寿险未审核企业纳税证明，9笔保单企业欠税仍承保，存在经营风险",
        "个人寿险未按要求报送核保数据，27笔核保数据未上报监管，违反数据报送规定",
        "年金险生存金领取年龄错误，15笔保单领取年龄提前，多支付生存金7.6万元",
        "重疾险理赔未审核治疗医院资质，12笔理赔案治疗医院无资质，无法佐证治疗真实性",
        "万能险保障成本扣除延迟，18笔保单超期扣除保障成本，违反核算时效要求",
        "寿险理赔档案保管不当，41笔理赔档案受潮损坏，无法查阅原始资料",
        "投连险未按约定调整投资组合，13款产品投资组合超6个月未调整，违反合同约定",
        "保单解除未收回原保单，14笔解除合同保单未收回，存在重复理赔风险",
        "团体寿险未投保主险附加险，8笔保单附加医疗险未投保，客户医疗费用无法理赔",
        "个人寿险保费豁免条款未履行，17笔保单符合豁免条件未豁免保费，多收保费4.2万元",
        "年金险未按监管要求计提负债，23笔年金险负债计提不足，违反偿付能力规定"
    ],
    "健康险": [
        "百万医疗险理赔未审核医保结算单，29笔理赔案无医保结算记录，多支付45万元",
        "长期护理险承保未评估护理需求，18笔保单投保人无需护理仍承保，涉保费9.3万元",
        "团健险承保未核实被保险人健康证明，34笔保单含带病人员，理赔率超预期50%",
        "重疾险（健康险渠道）条款未明确轻症定义，17笔理赔因轻症争议拒赔，引发投诉",
        "税优健康险未审核个税缴纳证明，22笔保单投保人未缴个税，违规享受税优政策",
        "医疗险理赔未核实医疗费用清单，19笔理赔案费用清单与发票不符，涉虚假报销",
        "短期健康险违规承诺保证续保，41笔保单销售时承诺终身续保，违反监管要求",
        "长期护理险服务次数未达标，15名客户每月服务次数少2次，未按协议履约",
        "团健险保费计算错误，按人数少算保费，27笔保单少收8.7万元",
        "百万医疗险未扣除免赔额，13笔理赔案未扣除1万元免赔额，多支付13万元",
        "重疾险理赔未审核病程记录，8笔理赔案无完整病程记录，无法确认发病时间",
        "税优健康险账户管理错误，17笔保单账户资金未单独管理，违反专户管理规定",
        "医疗险销售未提示免责条款，35名客户因未知晓免责拒赔投诉，违反销售规范",
        "长期护理险服务人员无资质，23名护理人员无执业证，服务质量不达标",
        "团健险理赔未审核员工在职证明，11笔理赔案离职员工报销，涉金额6.8万元",
        "百万医疗险未约定医院等级，9笔理赔案非定点医院治疗仍赔付，违反条款约定",
        "重疾险理赔未审核手术指征，12笔理赔案手术无医学指征，涉嫌过度治疗理赔",
        "税优健康险未按限额报销，8笔保单报销超年度限额，多支付4.2万元",
        "医疗险理赔档案缺失费用发票，28笔理赔案无原件发票，仅复印件，违反档案要求",
        "长期护理险评估标准不统一，不同评估员结果差异达40%，引发客户争议",
        "团健险未按工种调整保额，14笔高风险工种按普通工种承保，保额不足",
        "百万医疗险核保未审核既往病史，26笔保单投保人有慢性病仍承保，逆选择风险高",
        "重疾险条款更新未通知客户，19笔保单条款变更未告知，客户不知情引发投诉",
        "税优健康险未报送监管数据，24笔保单数据未及时上报，违反数据报送规定",
        "医疗险未按约定提供增值服务，31名客户未享受免费体检，违反服务承诺",
        "长期护理险费用结算错误，17笔服务费用多结算，合计5.9万元",
        "团健险续保未重新核保，18笔高理赔率团体仍按原条件续保，风险未管控",
        "百万医疗险理赔未核实住院天数，12笔理赔案虚增住院天数，多支付9.6万元",
        "重疾险理赔未审核基因检测结果，7笔理赔案基因检测不符，违规赔付32万元",
        "税优健康险退保未退还账户资金，9笔退保保单未退还账户余额，合计2.7万元",
        "医疗险核保未审核职业风险，21笔高风险职业投保人未加费，增加理赔风险",
        "长期护理险未按协议更换护理人员，14名客户要求更换人员未履约，引发投诉",
        "团健险未明确报销比例，16笔理赔案因比例争议拒赔，客户投诉率上升",
        "百万医疗险未扣除第三方赔付，10笔理赔案重复报销，多支付21万元",
        "重疾险理赔调查超时限，23笔理赔案调查超60天，违反监管时效要求",
        "税优健康险账户资金挪用，8笔账户资金被违规划转，涉金额4.3万元",
        "医疗险未按监管要求计提准备金，29笔未决理赔案准备金计提不足，违反财务规定",
        "长期护理险评估未实地进行，15笔评估仅电话核实，无法确认护理需求真实性",
        "团健险保费逾期未催收，22笔保费逾期超90天，未采取催收措施",
        "百万医疗险条款中医院范围未更新，12家新增定点医院未纳入，客户无法报销",
        "重疾险理赔未审核治疗方案，9笔理赔案治疗方案不符合医学规范，违规赔付18万元",
        "税优健康险未提示账户管理费，24名客户未知晓管理费扣除，引发投诉",
        "医疗险理赔未核实药品清单，17笔理赔案非医保药按医保药报销，多支付7.8万元",
        "长期护理险服务记录缺失，31笔服务无签字确认，无法佐证服务提供",
        "团健险未投保附加牙科险，14笔牙科治疗费用无法报销，客户投诉未保障",
        "百万医疗险核保未审核体检报告，18笔保单投保人未体检仍承保，存在健康风险",
        "重疾险等待期计算错误，11笔理赔案等待期少算30天，违规赔付25万元",
        "税优健康险未按年度结算，13笔保单年度结算延迟超30天，违反结算规则",
        "医疗险销售误导，承诺“全额报销”，28名客户投诉未全额报销，引发纠纷",
        "长期护理险未按监管要求备案，19款护理险产品未备案，违反产品监管规定",
        "团健险理赔未审核发票真实性，14笔理赔案使用虚假发票，涉及金额32万元",
        "百万医疗险未约定药品使用范围，8笔理赔案外购药报销争议，客户投诉无法报销",
        "重疾险理赔未审核病理诊断，16笔理赔案病理诊断不明确，无法确认重疾类型",
        "税优健康险未核实投保人身份，12笔保单冒名投保，涉嫌骗取税优优惠",
        "医疗险未及时更新报销目录，27笔理赔案药品已调出目录仍报销，多支付14万元",
        "长期护理险费用标准未公示，21名客户未知晓费用标准，引发价格争议",
        "团健险未按人数调整保费，15笔保单人数减少未减收保费，多收5.6万元",
        "百万医疗险理赔未审核出院小结，9笔理赔案出院小结与诊断不符，涉虚假理赔",
        "重疾险条款免责范围过宽，17笔理赔案因免责拒赔，违反监管公平性要求",
        "税优健康险账户收益计算错误，23笔账户收益少算，合计3.1万元",
        "医疗险核保权限违规下放，基层机构超权限承保高风险客户，19笔保单无审批",
        "长期护理险未提供应急护理服务，8名客户突发疾病未获应急护理，引发投诉",
        "团健险未审核企业资质，11笔保单企业无营业执照，违反承保条件",
        "百万医疗险未扣除自费项目，14笔理赔案自费项目全额报销，多支付18万元",
        "重疾险理赔未审核治疗费用，7笔理赔案治疗费用与病情不符，涉嫌虚增费用",
        "税优健康险退保手续费过高，16笔退保多收手续费，合计4.2万元",
        "医疗险理赔档案未归档，34笔2023年理赔案未在30天内归档，违反档案管理规定",
        "长期护理险评估人员无资质，24名评估员未取得护理评估证，违反人员管理规定",
        "团健险未按约定支付理赔金，12笔理赔金逾期支付超45天，引发客户投诉",
        "百万医疗险未审核转院证明，10笔理赔案无转院证明仍报销，违反条款约定",
        "重疾险未按监管要求进行消费者权益保护审查，21款产品未审查，违反监管规定",
        "税优健康险未参与大病保险统筹，9笔保单应统筹未统筹，客户未享受额外保障",
        "医疗险未提示续保审核要求，28名客户不知情续保需审核，保单被拒保",
        "长期护理险服务区域未覆盖，15名客户居住地无服务网点，无法享受服务",
        "团健险未明确免赔额，13笔理赔案因免赔额争议拒赔，客户投诉无明确规则",
        "百万医疗险核保未查询理赔记录，17笔保单投保人有多次理赔记录仍承保",
        "重疾险理赔未审核康复记录，8笔理赔案无康复治疗记录，无法确认治疗效果",
        "税优健康险未按要求进行信息披露，26笔保单未披露账户信息，违反披露规定",
        "医疗险未按协议与医院结算，14笔医院结算费用逾期超60天，引发合作纠纷",
        "长期护理险理赔未审核护理记录，19笔理赔案无护理日志，无法佐证服务提供",
        "团健险保费未及时入账，23笔保费到账超30天未确认收入，违反财务规定",
        "百万医疗险未约定检查项目范围，11笔理赔案非必要检查仍报销，多支付6.9万元",
        "重疾险销售未进行风险测评，35笔保单无测评记录，违反销售适当性要求",
        "税优健康险未核实投保人社保状态，18笔保单无社保仍承保，违反税优条件",
        "医疗险理赔未审核医疗服务资质，12笔理赔案医疗机构无执业许可证，违规报销",
        "长期护理险未按约定调整服务费用，17笔服务费用未随物价调整，引发服务商投诉",
        "团健险未投保住院津贴险，9笔理赔案无住院津贴，客户投诉保障不足",
        "百万医疗险理赔未核实身份，14笔理赔案冒名报销，涉及金额28万元",
        "重疾险未按约定支付轻症保险金，11笔轻症理赔案少付保险金，合计9.7万元",
        "税优健康险账户资金投资违规，8笔账户资金投向高风险资产，违反投资规则",
        "医疗险未按监管要求报送理赔数据，27笔理赔数据未及时上报，违反数据报送规定",
        "长期护理险未建立服务质量考核，23家服务商无考核记录，服务质量不达标",
        "团健险理赔未扣除医保报销，10笔理赔案重复报销，多支付15万元",
        "百万医疗险条款中等待期定义模糊，16笔理赔因等待期争议拒赔，客户投诉",
        "重疾险核保未审核家族病史，18笔保单投保人有家族重疾史仍承保，逆选择风险高",
        "税优健康险未退还超额保费，13笔保单多收保费未退还，合计3.8万元",
        "医疗险未按约定提供就医绿通，24名客户未享受绿通服务，违反服务承诺",
        "长期护理险未提示服务终止条件，15名客户不知情服务终止规则，引发纠纷",
        "团健险未审核被保险人年龄，14笔保单超龄参保，违反承保年龄限制",
        "百万医疗险未计提未决赔款准备金，31笔未决理赔案准备金不足，违反财务准则"
    ]
}

# 3. 生成200条数据
data = []
start_date = datetime(2022, 1, 1)
end_date = datetime(2023, 12, 31)
date_range = (end_date - start_date).days

# 遍历子公司类型和缺陷内容
for subsidiary in ["产险", "寿险", "健康险"]:
    for defect_content in defect_contents[subsidiary]:
        # 随机生成缺陷发生时间（精确到日）
        random_days = random.randint(0, date_range)
        defect_date = start_date + timedelta(days=random_days)
        defect_date_str = defect_date.strftime("%Y-%m-%d")

        # 随机选择省份、城市、区县
        province = random.choice(list(provinces_cities_districts.keys()))
        city = random.choice(provinces_cities_districts[province]["城市"])
        district = random.choice(provinces_cities_districts[province]["区县"])
        
        # 组装数据
        data.append({
            "发生时间": defect_date_str,
            "省": province,
            "市": city,
            "子公司": subsidiary,
            "分支结构": district,
            "缺陷内容": defect_content
        })

# 4. 转换为DataFrame并保存为Excel
df = pd.DataFrame(data)

# 打乱数据顺序（避免按生成顺序排列）
df = df.sample(frac=1, random_state=42).reset_index(drop=True)

# 保存为Excel文件
output_file = "./output/保险行业审计缺陷案例数据集.xlsx"
df.to_excel(output_file, index=False, engine="openpyxl")

# print(f"数据集生成完成！共{len(df)}条记录，已保存至：{output_file}")
# print("\n数据集前5条预览：")
# print(df.head())